import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

# Load dataset
df = pd.read_csv("titanic.csv")

# Check missing values
print(df.isnull().sum())

df['Age'].fillna(df['Age'].mean(), inplace=True)

df['Embarked'].fillna(df['Embarked'].mode()[0], inplace=True)

df.drop(['Cabin'], axis=1, inplace=True)

bins = [0, 12, 20, 40, 60, 100]
labels = ['Child', 'Teen', 'Adult', 'Middle Age', 'Senior']

df['AgeGroup'] = pd.cut(df['Age'], bins=bins, labels=labels)

df['FamilySize'] = df['SibSp'] + df['Parch']

age_survival = df.groupby('AgeGroup')['Survived'].mean()
print(age_survival)

port_survival = df.groupby('Embarked')['Survived'].mean()
print(port_survival)

family_survival = df.groupby('FamilySize')['Survived'].mean()
print(family_survival)

family_survival = df.groupby('FamilySize')['Survived'].mean()
print(family_survival)

plt.figure()
plt.hist(df['Age'], bins=20)
plt.title("Age Distribution")
plt.xlabel("Age")
plt.ylabel("Count")
plt.show()

plt.figure()
sns.heatmap(df.corr(numeric_only=True), annot=True)
plt.title("Correlation Heatmap")
plt.show()

plt.figure()
df.groupby('FamilySize')['Survived'].mean().plot(kind='bar')
plt.title("Survival Rate by Family Size")
plt.xlabel("Family Size")
plt.ylabel("Survival Rate")
plt.show()
